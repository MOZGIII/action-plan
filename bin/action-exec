#!/usr/bin/env bash
set -euo pipefail

ACTION_PATH="${ACTION_PATH:?set ACTION_PATH to the desired path}"
INPUT_TSCONFIG="${INPUT_TSCONFIG:-"$ACTION_PATH/tsconfig.runtime.json"}"

CURRENT_PWD="$(pwd)"

printf 'Using tsconfig file: %s\n' "$INPUT_TSCONFIG"

cd "$ACTION_PATH"
exec yarn \
  "$ACTION_PATH" \
  --cwd "$CURRENT_PWD" \
  ts-node-esm \
  --project "$INPUT_TSCONFIG" \
  "$ACTION_PATH/build/index.js" \
  "$@"
